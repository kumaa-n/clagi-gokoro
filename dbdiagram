Table users {
  id bigint [pk]
  name varchar [unique, not null, note: 'ニックネーム']
  email varchar [unique, note: 'メールアドレス（NULL/空文字はユニーク対象から除外）']
  encrypted_password varchar [not null, note: '暗号化済みパスワード']
  reset_password_token varchar [note: 'パスワードリセットトークン']
  reset_password_sent_at datetime [note: 'リセットメール送信日時']
  remember_created_at datetime [note: 'ログイン記憶日時']
  self_introduction text [note: '自己紹介']
  created_at datetime [not null]
  updated_at datetime [not null]

  confirmation_token varchar [note: '確認トークン（Confirmable）']
  confirmed_at datetime [note: '確認完了日時（Confirmable）']
  confirmation_sent_at datetime [note: '確認メール送信日時（Confirmable）']
  unconfirmed_email varchar [note: '確認待ちメール（Confirmable）']

  provider varchar [note: 'OAuthプロバイダ']
  provider_uid varchar [note: 'OAuth側ユーザーID']

  Note: '登録ユーザーの基本情報（Devise, OAuth）'
}

Table songs {
  uuid uuid [pk]
  title varchar [not null, note: 'タイトル']
  composer varchar [note: '作曲者']
  arranger varchar [note: '編曲者']
  created_at datetime [not null]
  updated_at datetime [not null]

  normalized_title varchar [note: '正規化タイトル（検索用）']
  normalized_composer varchar [note: '正規化作曲者（検索用）']
  normalized_arranger varchar [note: '正規化編曲者（検索用）']

  Note: '曲マスタ'
}

Table reviews {
  uuid uuid [pk]
  user_id bigint [not null, ref: > users.id]
  song_uuid uuid [not null, ref: > songs.uuid]

  tempo_rating integer [not null, note: 'テンポ評価']
  fingering_technique_rating integer [not null, note: '運指技巧評価']
  plucking_technique_rating integer [not null, note: '弾弦技巧評価']
  expression_rating integer [not null, note: '表現力評価']
  memorization_rating integer [not null, note: '暗譜・構成理解評価']
  overall_rating decimal [not null, note: '総合評価']

  summary text [note: '総評コメント']
  tags text[] [note: 'タグ（text配列）'] // Rails: text[] default []

  created_at datetime [not null]
  updated_at datetime [not null]

  Note: '曲へのレビュー'
}

Table review_favorites {
  id bigint [pk]
  user_id bigint [not null, ref: > users.id]
  review_uuid uuid [not null, ref: > reviews.uuid]
  created_at datetime [not null]
  updated_at datetime [not null]

  Note: 'お気に入りレビュー'
}
