<div class="relative card bg-white border border-base-200/60 shadow-sm hover:shadow-md hover:-translate-y-1 transition-all duration-300 group" data-controller="review-chart">
  <%# カード全体をリンクにするための透明なリンク要素 %>
  <%= link_to "", review_path(review), class: "absolute inset-0 z-20", aria: { hidden: true } %>

  <%# グラフエリア %>
  <div class="bg-base-100 p-4 flex items-center justify-center border-b border-base-100 relative rounded-t-2xl" style="height: 200px;">
    <div style="width: 100%; height: 100%; max-width: 180px; max-height: 180px;">
      <canvas
        data-review-chart-target="canvas"
        data-tempo="<%= review.tempo_rating %>"
        data-fingering="<%= review.fingering_technique_rating %>"
        data-plucking="<%= review.plucking_technique_rating %>"
        data-expression="<%= review.expression_rating %>"
        data-memorization="<%= review.memorization_rating %>"
      ></canvas>
    </div>
  </div>

  <div class="card-body p-5 md:p-6">
    <div class="flex items-center mb-2">
      <div class="flex items-center gap-2">
        <span class="text-xs text-neutral/60">総合難易度</span>
        <%= star_rating_display(review.overall_rating, size: "sm") %>
        <span class="text-sm font-medium text-neutral"><%= format_overall_rating(review.overall_rating) %></span>
      </div>
    </div>

    <div class="space-y-1 mb-2">
      <div class="flex items-center gap-2 text-xs text-neutral/80 min-w-0">
        <%= inline_svg_tag("user.svg", class: "w-4 h-4 shrink-0") %>
        <span class="text-neutral/60 shrink-0">投稿者</span>
        <span class="font-medium text-primary truncate min-w-0"><%= review.user.name %></span>
      </div>
      <div class="flex items-center gap-2 text-xs text-neutral/80 min-w-0">
        <%= inline_svg_tag("calendar.svg", class: "w-4 h-4 shrink-0") %>
        <span class="text-neutral/60 shrink-0">投稿日</span>
        <span class="truncate min-w-0"><%= format_date(review.created_at) %></span>
      </div>
    </div>

    <% if review.tags.present? %>
      <div class="flex flex-wrap gap-1 mb-2" data-controller="tag-filter">
        <%= render_tags(review.tags, song: review.song, linkable: true) %>
      </div>
    <% end %>

    <div class="flex items-center justify-between mt-auto">
      <div class="flex-1"></div>
      <div class="flex items-center gap-1 text-primary text-xs font-medium group-hover:text-primary/80 transition-colors">
        <span>詳細</span>
        <%= inline_svg_tag "chevron-right.svg" %>
      </div>
    </div>
  </div>
</div>
